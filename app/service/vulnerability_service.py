import pandas as pd
from pydantic import BaseModel


class VulnerabilityItem(BaseModel):
    id: int
    kategori_kerentanan: str


class VulnerabilityService:
    def __init__(self):
        # Load data from the CSV file
        self.data = pd.read_csv("app/data/kerentanan.csv")

    def get_vulnerability_by_id(self, data_id: int) -> VulnerabilityItem:
        data_row = self.data[self.data['id'] == data_id]
        if not data_row.empty:
            data_dict = data_row.to_dict(orient='records')[0]
            return VulnerabilityItem(**data_dict)
        return None
